<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>पाटील Kirana - Your Daily Needs, Delivered Fast</title>

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Google Fonts: Poppins, Lato, Mukta (for Marathi) -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Lato:wght@400;700&family=Poppins:wght@400;600;700&family=Mukta:wght@400;700&display=swap" rel="stylesheet">

    <!-- Font Awesome for Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">

    <!-- Custom Styles -->
    <style>
        body {
            font-family: 'Lato', sans-serif;
            color: #1f2937;
            scroll-behavior: smooth;
            background: linear-gradient(to bottom, #f3f4f6, #e5e7eb);
        }
        .font-poppins { font-family: 'Poppins', sans-serif; }
        .font-marathi { font-family: 'Mukta', sans-serif; }
        .bg-primary { background-color: #7c3aed; }
        .text-primary { color: #7c3aed; }
        .border-primary { border-color: #7c3aed; }
        .ring-primary { --tw-ring-color: #7c3aed; }

        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }

        .page-section { display: none; }
        .page-section.active { display: block; animation: fadeIn 0.6s ease-in-out; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

        .animate-on-scroll { opacity: 0; transform: translateY(20px); transition: opacity 0.6s ease-out, transform 0.6s ease-out; }
        .animate-on-scroll.visible { opacity: 1; transform: translateY(0); }

        .btn { transition: all 0.3s ease; }
        .btn:hover { transform: scale(1.05); box-shadow: 0 4px 15px rgba(0,0,0,0.2); }
        .btn:active { transform: scale(0.98); }

        .product-card { transition: transform 0.3s ease, box-shadow 0.3s ease; }
        .product-card:hover { transform: translateY(-8px); box-shadow: 0 12px 24px rgba(0,0,0,0.15); }
        .product-card img { object-fit: contain; background-color: #ffffff; }

        .hero-banner { background: linear-gradient(135deg, #7c3aed, #4c1d95); }
        .carousel { position: relative; overflow: hidden; }
        .carousel-item { transition: transform 0.5s ease-in-out; }
        .carousel-btn { transition: background-color 0.3s ease; }
        .carousel-btn:hover { background-color: #6d28d9; }

        #loader {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(255, 255, 255, 0.95);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            transition: opacity 0.5s ease;
        }
        .spinner {
            border: 6px solid #f3f3f3;
            border-top: 6px solid #7c3aed;
            border-radius: 50%;
            width: 60px;
            height: 60px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }

        #back-to-top {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: #7c3aed;
            color: white;
            padding: 12px;
            border-radius: 50%;
            z-index: 50;
            transition: opacity 0.3s ease;
        }
        #back-to-top.hidden { opacity: 0; pointer-events: none; }
    </style>
</head>
<body>
    <!-- Pre-loader -->
    <div id="loader">
        <div class="spinner"></div>
    </div>

    <!-- Header Section -->
    <header class="bg-white shadow-lg sticky top-0 z-40">
        <div class="container mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex items-center justify-between h-20">
                <a href="#home" id="logo" class="nav-link text-3xl font-bold text-primary">
                    <span class="font-marathi">पाटील</span> <span class="font-poppins">Kirana</span>
                </a>
                <nav class="hidden md:flex items-center space-x-8">
                    <a href="#home" class="nav-link text-gray-600 hover:text-primary transition font-semibold">Home</a>
                    <a href="#products" class="nav-link text-gray-600 hover:text-primary transition font-semibold">Shop</a>
                    <a href="#home" class="nav-link text-gray-600 hover:text-primary transition font-semibold">Offers</a>
                    <a href="#footer" class="nav-link text-gray-600 hover:text-primary transition font-semibold">Contact</a>
                </nav>
                <div class="flex items-center space-x-4">
                    <div class="relative hidden sm:block">
                        <input type="search" id="search-input" placeholder="Search for products..." class="w-48 lg:w-72 pl-4 pr-10 py-2.5 border border-gray-300 rounded-full focus:outline-none focus:ring-2 ring-primary transition" aria-label="Search products">
                        <i class="fas fa-search absolute top-1/2 right-3 -translate-y-1/2 text-gray-400"></i>
                    </div>
                    <a href="#account" class="nav-link text-gray-600 hover:text-primary transition" aria-label="Account"><i class="fas fa-user text-xl"></i></a>
                    <a href="#cart" id="cart-icon-link" class="nav-link text-gray-600 hover:text-primary transition relative" aria-label="Cart">
                        <i class="fas fa-shopping-cart text-xl"></i>
                        <span id="cart-item-count" class="absolute -top-2 -right-2 bg-primary text-white text-xs font-bold rounded-full h-5 w-5 flex items-center justify-center">0</span>
                    </a>
                    <button id="mobile-menu-button" class="md:hidden text-gray-600 hover:text-primary focus:outline-none" aria-label="Toggle menu"><i class="fas fa-bars text-xl"></i></button>
                </div>
            </div>
        </div>
        <div id="mobile-menu" class="hidden md:hidden bg-white border-t shadow-md">
            <nav class="flex flex-col p-4 space-y-3">
                <a href="#home" class="nav-link text-gray-600 hover:text-primary transition font-semibold">Home</a>
                <a href="#products" class="nav-link text-gray-600 hover:text-primary transition font-semibold">Shop</a>
                <a href="#home" class="nav-link text-gray-600 hover:text-primary transition font-semibold">Offers</a>
                <a href="#footer" class="nav-link text-gray-600 hover:text-primary transition font-semibold">Contact</a>
            </nav>
        </div>
    </header>

    <!-- Main Content -->
    <main id="main-content" class="container mx-auto px-4 sm:px-6 lg:px-8 py-12">
        <!-- Home Page Section -->
        <section id="home" class="page-section active">
            <div class="hero-banner rounded-2xl overflow-hidden shadow-xl mb-12 animate-on-scroll">
                <div class="flex flex-col md:flex-row items-center">
                    <div class="w-full md:w-1/2 p-8 lg:p-12 text-center md:text-left">
                        <h1 class="text-4xl sm:text-5xl lg:text-6xl font-bold text-white font-poppins mb-4">Your Daily Needs, Delivered Fast</h1>
                        <p class="text-gray-200 mb-8 text-lg">Fresh groceries and household essentials delivered to your doorstep with a smile.</p>
                        <a href="#products" class="nav-link bg-white text-primary font-bold py-3 px-8 rounded-full hover:bg-gray-100 transition-all text-lg btn">Shop Now</a>
                    </div>
                    <div class="w-full md:w-1/2 h-64 md:h-96">
                        <img src="https://images.unsplash.com/photo-1600585154340-be6161a56a0c" alt="Fresh groceries and vegetables on a table" class="w-full h-full object-cover">
                    </div>
                </div>
            </div>
            <h2 class="text-3xl font-bold mb-8 text-center font-poppins animate-on-scroll">Popular Categories</h2>
            <div id="home-categories" class="grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-6 gap-4 md:gap-6 mb-12"></div>
            <h2 class="text-3xl font-bold mb-8 text-center font-poppins animate-on-scroll">Special Offers</h2>
            <div class="carousel relative">
                <div id="home-offers" class="flex space-x-6 overflow-x-hidden pb-6 no-scrollbar"></div>
                <button class="carousel-btn absolute top-1/2 left-0 -translate-y-1/2 bg-primary text-white p-2 rounded-full" id="prev-offer"><i class="fas fa-chevron-left"></i></button>
                <button class="carousel-btn absolute top-1/2 right-0 -translate-y-1/2 bg-primary text-white p-2 rounded-full" id="next-offer"><i class="fas fa-chevron-right"></i></button>
            </div>
            <div class="mt-16 bg-white rounded-2xl p-8 grid grid-cols-1 sm:grid-cols-3 gap-8 text-center shadow-xl animate-on-scroll">
                <div class="animate-on-scroll">
                    <i class="fas fa-shipping-fast text-primary text-4xl mb-3"></i>
                    <h3 class="font-bold text-xl font-poppins">Fast Local Delivery</h3>
                    <p class="text-gray-600">Get your order within hours, not days.</p>
                </div>
                <div class="animate-on-scroll" style="transition-delay: 150ms;">
                    <i class="fas fa-leaf text-primary text-4xl mb-3"></i>
                    <h3 class="font-bold text-xl font-poppins">Fresh & Quality Products</h3>
                    <p class="text-gray-600">Handpicked items for the best quality.</p>
                </div>
                <div class="animate-on-scroll" style="transition-delay: 300ms;">
                    <i class="fas fa-shield-alt text-primary text-4xl mb-3"></i>
                    <h3 class="font-bold text-xl font-poppins">Secure Payments</h3>
                    <p class="text-gray-600">Your transactions are safe and secure.</p>
                </div>
            </div>
        </section>

        <!-- Products Section -->
        <section id="products" class="page-section">
            <h1 class="text-3xl font-bold mb-8 font-poppins">All Products</h1>
            <div class="flex flex-col md:flex-row gap-8">
                <aside class="w-full md:w-1/4 lg:w-1/5 animate-on-scroll">
                    <div class="bg-white p-6 rounded-2xl shadow-md sticky top-28">
                        <h2 class="font-bold text-xl mb-4 font-poppins">Filters</h2>
                        <div id="filters-container" class="space-y-6"></div>
                    </div>
                </aside>
                <div class="w-full md:w-3/4 lg:w-4/5">
                    <div id="product-grid" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6"></div>
                </div>
            </div>
        </section>

        <!-- Cart Section -->
        <section id="cart" class="page-section">
            <h1 class="text-3xl font-bold mb-8 font-poppins">Your Shopping Cart</h1>
            <div id="cart-content" class="flex flex-col lg:flex-row gap-8">
                <div id="cart-items-container" class="w-full lg:w-2/3 flex flex-col gap-4"></div>
                <div id="order-summary-container" class="w-full lg:w-1/3 hidden">
                    <div class="bg-white border rounded-2xl p-6 sticky top-28 shadow-md">
                        <h2 class="text-xl font-bold mb-4 font-poppins">Order Summary</h2>
                        <div class="space-y-3 mb-4">
                            <div class="flex justify-between"><span>Subtotal</span><span id="cart-subtotal">₹0.00</span></div>
                            <div class="flex justify-between"><span>Delivery Fee</span><span id="cart-delivery-fee">₹0.00</span></div>
                            <div class="border-t pt-3 flex justify-between font-bold text-lg"><span>Total</span><span id="cart-total">₹0.00</span></div>
                        </div>
                        <button class="w-full bg-primary text-white font-bold py-3 rounded-lg btn disabled:opacity-50 disabled:cursor-not-allowed" id="checkout-btn" disabled>Proceed to Checkout</button>
                    </div>
                </div>
            </div>
        </section>

        <!-- Account Section -->
        <section id="account" class="page-section">
            <h1 class="text-3xl font-bold mb-8 font-poppins">My Account</h1>
            <div class="flex flex-col md:flex-row gap-8">
                <aside class="w-full md:w-1/4 lg:w-1/5 animate-on-scroll">
                    <div class="bg-white p-4 rounded-2xl shadow-md">
                        <div class="space-y-2">
                            <a href="#" class="block font-semibold p-3 rounded-lg bg-purple-100 text-primary">Order History</a>
                            <a href="#" class="block font-semibold p-3 rounded-lg hover:bg-gray-100">Manage Addresses</a>
                            <a href="#" class="block font-semibold p-3 rounded-lg hover:bg-gray-100">Profile Settings</a>
                            <a href="#" class="block font-semibold p-3 rounded-lg hover:bg-gray-100">Logout</a>
                        </div>
                    </div>
                </aside>
                <div class="w-full md:w-3/4 lg:w-4/5 animate-on-scroll" style="transition-delay: 150ms;">
                    <h2 class="text-xl font-bold mb-4 font-poppins">Order History</h2>
                    <div class="space-y-4">
                        <div class="bg-white border rounded-lg p-4 flex flex-col sm:flex-row justify-between items-start sm:items-center shadow-sm">
                            <div class="flex-grow"><p class="font-bold">Order #PK-1025</p><p class="text-sm text-gray-500">Date: July 25, 2025</p></div>
                            <div class="my-2 sm:my-0"><span class="bg-green-100 text-green-800 text-sm font-medium px-2.5 py-0.5 rounded">Delivered</span></div>
                            <div class="my-2 sm:my-0"><p class="font-semibold">Total: ₹540.00</p></div>
                            <div><a href="#" class="text-primary font-semibold hover:underline">View Details</a></div>
                        </div>
                        <div class="bg-white border rounded-lg p-4 flex flex-col sm:flex-row justify-between items-start sm:items-center shadow-sm">
                            <div class="flex-grow"><p class="font-bold">Order #PK-1024</p><p class="text-sm text-gray-500">Date: July 20, 2025</p></div>
                            <div class="my-2 sm:my-0"><span class="bg-yellow-100 text-yellow-800 text-sm font-medium px-2.5 py-0.5 rounded">Processing</span></div>
                            <div class="my-2 sm:my-0"><p class="font-semibold">Total: ₹250.00</p></div>
                            <div><a href="#" class="text-primary font-semibold hover:underline">Track Order</a></div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Toast Notification -->
        <div id="toast-notification" class="fixed bottom-5 right-5 bg-gray-800 text-white py-3 px-6 rounded-lg shadow-lg transform translate-y-20 opacity-0 transition-all duration-500 z-50">
            <i class="fas fa-check-circle text-green-400 mr-2"></i><span id="toast-message"></span>
        </div>

        <!-- Confirmation Modal -->
        <div id="confirm-modal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center hidden z-50">
            <div class="bg-white p-6 rounded-2xl shadow-xl max-w-sm w-full">
                <h3 class="text-lg font-bold mb-4 font-poppins">Confirm Removal</h3>
                <p class="text-gray-600 mb-6">Are you sure you want to remove this item from your cart?</p>
                <div class="flex justify-end gap-4">
                    <button id="cancel-remove" class="px-4 py-2 text-gray-600 rounded-lg hover:bg-gray-100">Cancel</button>
                    <button id="confirm-remove" class="px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600">Remove</button>
                </div>
            </div>
        </div>
    </main>

    <!-- Footer Section -->
    <footer id="footer" class="bg-gray-900 text-white">
        <div class="container mx-auto px-4 sm:px-6 lg:px-8 py-12">
            <div class="grid grid-cols-1 md:grid-cols-4 gap-8">
                <div>
                    <h3 class="text-xl font-poppins font-bold mb-4"><span class="font-marathi">पाटील</span> Kirana</h3>
                    <p class="text-gray-400">Your trusted neighborhood store, now online. Quality products, fast delivery.</p>
                    <div class="flex space-x-4 mt-4">
                        <a href="#" class="text-gray-400 hover:text-white" aria-label="Facebook"><i class="fab fa-facebook-f text-xl"></i></a>
                        <a href="#" class="text-gray-400 hover:text-white" aria-label="Twitter"><i class="fab fa-twitter text-xl"></i></a>
                        <a href="#" class="text-gray-400 hover:text-white" aria-label="Instagram"><i class="fab fa-instagram text-xl"></i></a>
                    </div>
                </div>
                <div>
                    <h3 class="font-bold mb-4 font-poppins">Quick Links</h3>
                    <ul class="space-y-2 text-gray-400">
                        <li><a href="#" class="hover:text-white">About Us</a></li>
                        <li><a href="#" class="hover:text-white">Contact Us</a></li>
                        <li><a href="#" class="hover:text-white">FAQ</a></li>
                    </ul>
                </div>
                <div>
                    <h3 class="font-bold mb-4 font-poppins">Contact</h3>
                    <ul class="space-y-2 text-gray-400">
                        <li class="flex items-start"><i class="fas fa-map-marker-alt mt-1 mr-2"></i>Pune, Maharashtra, India</li>
                        <li class="flex items-center"><i class="fas fa-phone-alt mr-2"></i>+91 12345 67890</li>
                        <li class="flex items-center"><i class="fas fa-envelope mr-2"></i>support@patilkirana.com</li>
                    </ul>
                </div>
                <div>
                    <h3 class="font-bold mb-4 font-poppins">Newsletter</h3>
                    <p class="text-gray-400 mb-4">Subscribe for exclusive offers!</p>
                    <div class="flex">
                        <input type="email" placeholder="Your email" class="w-full p-2 rounded-l-lg border border-gray-700 focus:outline-none focus:ring-2 ring-primary" aria-label="Newsletter email">
                        <button class="bg-primary text-white px-4 rounded-r-lg hover:bg-purple-700">Subscribe</button>
                    </div>
                </div>
            </div>
            <div class="mt-8 pt-8 border-t border-gray-800 text-center text-gray-500">
                <p>&copy; 2025 पाटील Kirana. All Rights Reserved. Designed for portfolio purposes.</p>
            </div>
        </div>
    </footer>

    <!-- Back to Top Button -->
    <button id="back-to-top" class="hidden" aria-label="Back to top"><i class="fas fa-arrow-up"></i></button>

    <script>
    document.addEventListener('DOMContentLoaded', function() {
        const loader = document.getElementById('loader');
        const products = [
            { id: 1, name: 'Aashirvaad Atta', category: 'Grains', price: 250, size: '5 kg', imageUrl: 'https://images.pexels.com/photos/3952050/pexels-photo-3952050.jpeg', offer: 15 },
            { id: 2, name: 'Fortune Sunlite Oil', category: 'Oils', price: 150, size: '1 Litre', imageUrl: 'https://images.unsplash.com/photo-1612544446847-776f2e0a3440', bestseller: true },
            { id: 3, name: 'Maggi Noodles', category: 'Snacks', price: 55, size: 'Pack of 4', imageUrl: 'https://pixabay.com/photos/noodles-instant-noodles-food-6280583/' },
            { id: 4, name: 'Amul Butter', category: 'Dairy', price: 265, size: '500g', imageUrl: 'https://images.pexels.com/photos/7490119/pexels-photo-7490119.jpeg' },
            { id: 5, name: 'Everest Chilli Powder', category: 'Spices', price: 75, size: '200g', imageUrl: 'https://images.unsplash.com/photo-1615485290382-441e4d049cb5' },
            { id: 6, name: 'Everest Turmeric Powder', category: 'Spices', price: 60, size: '200g', imageUrl: 'https://images.pexels.com/photos/4199079/pexels-photo-4199079.jpeg' },
            { id: 7, name: 'Tata Salt', category: 'Spices', price: 25, size: '1 kg', imageUrl: 'https://pixabay.com/photos/salt-seasoning-food-white-1331494/' },
            { id: 8, name: 'Daawat Basmati Rice', category: 'Grains', price: 180, size: '1 kg', imageUrl: 'https://images.unsplash.com/photo-1611270418597-1405f3f2706e' },
            { id: 9, name: 'Britannia Milk Bread', category: 'Dairy', price: 45, size: '400g', imageUrl: 'https://images.pexels.com/photos/4199066/pexels-photo-4199066.jpeg' },
            { id: 10, name: 'Surf Excel Matic Liquid', category: 'Cleaning', price: 220, size: '1 Litre', imageUrl: 'https://pixabay.com/photos/detergent-liquid-laundry-1834183/' },
            { id: 11, name: 'Lays Classic Chips', category: 'Snacks', price: 20, size: '52g', imageUrl: 'https://images.unsplash.com/photo-1612972485101-2d9e0f1f0a6c' },
            { id: 12, name: 'Coca-Cola', category: 'Beverages', price: 40, size: '750ml', imageUrl: 'https://images.pexels.com/photos/266830/pexels-photo-266830.jpeg' },
            { id: 13, name: 'Tata Tea Gold', category: 'Beverages', price: 550, size: '1 kg', imageUrl: 'https://images.unsplash.com/photo-1629474066720-b9446e535a27' },
            { id: 14, name: 'Harpic Toilet Cleaner', category: 'Cleaning', price: 95, size: '500ml', imageUrl: 'https://pixabay.com/photos/cleaning-products-household-1834184/' },
            { id: 15, name: 'Amul Gold Milk', category: 'Dairy', price: 30, size: '500ml', imageUrl: 'https://images.pexels.com/photos/533314/pexels-photo-533314.jpeg' }
        ];

        const cartItems = [];
        const pageSections = document.querySelectorAll('.page-section');
        const navLinks = document.querySelectorAll('.nav-link');
        const mobileMenuButton = document.getElementById('mobile-menu-button');
        const mobileMenu = document.getElementById('mobile-menu');
        const searchInput = document.getElementById('search-input');
        const productGrid = document.getElementById('product-grid');
        const filtersContainer = document.getElementById('filters-container');
        const homeCategoriesContainer = document.getElementById('home-categories');
        const homeOffersContainer = document.getElementById('home-offers');
        const cartItemCountEl = document.getElementById('cart-item-count');
        const toast = document.getElementById('toast-notification');
        const toastMessage = document.getElementById('toast-message');
        const cartItemsContainer = document.getElementById('cart-items-container');
        const orderSummaryContainer = document.getElementById('order-summary-container');
        const cartSubtotalEl = document.getElementById('cart-subtotal');
        const cartDeliveryFeeEl = document.getElementById('cart-delivery-fee');
        const cartTotalEl = document.getElementById('cart-total');
        const checkoutBtn = document.getElementById('checkout-btn');
        const backToTopBtn = document.getElementById('back-to-top');
        const confirmModal = document.getElementById('confirm-modal');
        const confirmRemoveBtn = document.getElementById('confirm-remove');
        const cancelRemoveBtn = document.getElementById('cancel-remove');
        const prevOfferBtn = document.getElementById('prev-offer');
        const nextOfferBtn = document.getElementById('next-offer');

        let removeIndex = null;

        // Debounce function for search
        function debounce(func, wait) {
            let timeout;
            return function executedFunction(...args) {
                const later = () => {
                    clearTimeout(timeout);
                    func(...args);
                };
                clearTimeout(timeout);
                timeout = setTimeout(later, wait);
            };
        }

        // Render Functions
        function createProductCard(product, isOfferCard = false) {
            const originalPrice = product.offer ? `₹${(product.price / (1 - product.offer / 100)).toFixed(0)}` : '';
            const cardClass = isOfferCard ? 'carousel-item flex-shrink-0 w-80' : '';
            return `
            <div class="${cardClass} group product-card bg-white border rounded-2xl overflow-hidden flex flex-col shadow-md animate-on-scroll" data-id="${product.id}">
                <div class="relative">
                    <img src="${product.imageUrl}" alt="${product.name}" class="w-full h-56 object-contain bg-white p-4">
                    ${product.offer ? `<div class="absolute top-3 left-3 bg-red-500 text-white text-xs font-bold px-2.5 py-1 rounded-full">${product.offer}% OFF</div>` : ''}
                    ${product.bestseller ? `<div class="absolute top-3 left-3 bg-green-500 text-white text-xs font-bold px-2.5 py-1 rounded-full">BESTSELLER</div>` : ''}
                </div>
                <div class="p-6 flex flex-col flex-grow">
                    <h3 class="font-semibold text-lg font-poppins">${product.name}</h3>
                    <p class="text-gray-500 text-sm">${product.size}</p>
                    <div class="flex-grow"></div>
                    <div class="flex items-center justify-between mt-4">
                        <p class="font-bold text-primary text-xl">₹${product.price} ${product.offer ? `<span class="text-sm font-normal text-gray-500 line-through">${originalPrice}</span>` : ''}</p>
                        <button class="add-to-cart-btn bg-primary text-white px-4 py-2 rounded-lg btn font-poppins">Add to Cart</button>
                    </div>
                </div>
            </div>`;
        }

        function renderProducts(productsToRender) {
            productGrid.innerHTML = productsToRender.length === 0 ? 
                `<p class="col-span-full text-center text-gray-500 text-lg">No products found.</p>` : 
                productsToRender.map(product => createProductCard(product)).join('');
            attachAddToCartListeners();
        }

        function renderFilters() {
            const categories = ['All', ...new Set(products.map(p => p.category))];
            filtersContainer.innerHTML = `
                <div>
                    <h3 class="font-semibold text-lg mb-2 font-poppins">Category</h3>
                    <div class="space-y-2">
                        ${categories.map(cat => `<a href="#" class="category-filter block text-gray-600 hover:text-primary transition font-medium" data-category="${cat}">${cat}</a>`).join('')}
                    </div>
                </div>`;
            document.querySelectorAll('.category-filter').forEach(link => link.addEventListener('click', handleFilterClick));
        }

        function renderHomePageContent() {
            const categories = [...new Set(products.map(p => p.category))].slice(0, 6);
            const categoryIcons = {
                Grains: 'https://images.pexels.com/photos/4112065/pexels-photo-4112065.jpeg',
                Spices: 'https://images.unsplash.com/photo-1615485290382-441e4d049cb5',
                Snacks: 'https://images.pexels.com/photos/1583884/pexels-photo-1583884.jpeg',
                Dairy: 'https://images.pexels.com/photos/533314/pexels-photo-533314.jpeg',
                Cleaning: 'https://pixabay.com/photos/cleaning-products-household-1834184/',
                Oils: 'https://images.unsplash.com/photo-1612544446847-776f2e0a3440',
                Beverages: 'https://images.pexels.com/photos/266830/pexels-photo-266830.jpeg'
            };
            homeCategoriesContainer.innerHTML = categories.map((cat, i) => `
                <div class="animate-on-scroll" style="transition-delay: ${i * 100}ms;">
                    <a href="#products" class="category-home-link group text-center block bg-white border rounded-2xl p-4 product-card shadow-md" data-category="${cat}">
                        <img src="${categoryIcons[cat]}" alt="${cat} category" class="mx-auto h-24 w-24 rounded-full mb-3 shadow-sm object-cover">
                        <span class="font-semibold text-lg font-poppins">${cat}</span>
                    </a>
                </div>`).join('');

            const offerProducts = products.filter(p => p.offer || p.bestseller).slice(0, 4);
            homeOffersContainer.innerHTML = offerProducts.map(p => createProductCard(p, true)).join('');
            attachAddToCartListeners();
            setupCarousel();
            document.querySelectorAll('.category-home-link').forEach(link => {
                link.addEventListener('click', e => {
                    e.preventDefault();
                    const category = e.currentTarget.dataset.category;
                    showPage('products');
                    document.querySelectorAll('.category-filter').forEach(f => f.classList.remove('text-primary', 'font-bold'));
                    document.querySelector(`.category-filter[data-category="${category}"]`).classList.add('text-primary', 'font-bold');
                    handleFilter();
                });
            });
        }

        function setupCarousel() {
            const items = homeOffersContainer.querySelectorAll('.carousel-item');
            let currentIndex = 0;
            const totalItems = items.length;

            function showItem(index) {
                items.forEach((item, i) => {
                    item.style.transform = `translateX(${-index * 100}%)`;
                });
            }

            prevOfferBtn.addEventListener('click', () => {
                currentIndex = (currentIndex === 0) ? totalItems - 1 : currentIndex - 1;
                showItem(currentIndex);
            });

            nextOfferBtn.addEventListener('click', () => {
                currentIndex = (currentIndex === totalItems - 1) ? 0 : currentIndex + 1;
                showItem(currentIndex);
            });

            showItem(currentIndex);
            setInterval(() => {
                currentIndex = (currentIndex === totalItems - 1) ? 0 : currentIndex + 1;
                showItem(currentIndex);
            }, 5000);
        }

        // Event Handlers
        function attachAddToCartListeners() {
            document.querySelectorAll('.add-to-cart-btn').forEach(button => {
                button.addEventListener('click', handleAddToCart);
            });
        }

        function handleFilterClick(e) {
            e.preventDefault();
            document.querySelectorAll('.category-filter').forEach(link => link.classList.remove('text-primary', 'font-bold'));
            e.target.classList.add('text-primary', 'font-bold');
            handleFilter();
        }

        function handleFilter() {
            const searchTerm = searchInput.value.toLowerCase();
            const activeCategory = document.querySelector('.category-filter.text-primary')?.dataset.category || 'All';
            const filteredProducts = products.filter(p => 
                p.name.toLowerCase().includes(searchTerm) && 
                (activeCategory === 'All' || p.category === activeCategory)
            );
            renderProducts(filteredProducts);
        }

        function handleAddToCart(e) {
            const card = e.target.closest('.product-card');
            const productId = parseInt(card.dataset.id);
            const product = products.find(p => p.id === productId);
            const existingItem = cartItems.find(item => item.id === productId);
            if (existingItem) {
                existingItem.quantity++;
                showToast(`${product.name} quantity updated!`);
            } else {
                cartItems.push({ ...product, quantity: 1 });
                showToast(`${product.name} added to cart!`);
            }
            updateCart();
        }

        function updateCart() {
            const count = cartItems.reduce((total, item) => total + item.quantity, 0);
            cartItemCountEl.textContent = count;
            cartItemCountEl.classList.add('transform', 'scale-125', 'bg-red-500');
            setTimeout(() => cartItemCountEl.classList.remove('transform', 'scale-125', 'bg-red-500'), 300);
            updateCartView();
        }

        function updateCartView() {
            if (!document.getElementById('cart').classList.contains('active')) return;
            cartItemsContainer.innerHTML = cartItems.length === 0 ? 
                `<div id="empty-cart-message" class="bg-white p-8 rounded-2xl text-center shadow-md">
                    <i class="fas fa-shopping-cart text-5xl text-gray-300 mb-4"></i>
                    <h2 class="text-2xl font-semibold font-poppins">Your cart is empty</h2>
                    <p class="text-gray-500">Looks like you haven't added anything yet.</p>
                    <a href="#products" class="nav-link mt-6 inline-block bg-primary text-white font-bold py-3 px-8 rounded-full btn">Start Shopping</a>
                </div>` : '';
            orderSummaryContainer.classList.toggle('hidden', cartItems.length === 0);
            checkoutBtn.disabled = cartItems.length === 0;
            let subtotal = 0;
            cartItems.forEach((item, index) => {
                const itemEl = document.createElement('div');
                itemEl.className = 'bg-white border rounded-2xl p-4 flex items-center gap-4 animate-on-scroll visible shadow-sm';
                itemEl.innerHTML = `
                    <img src="${item.imageUrl}" alt="${item.name}" class="w-20 h-20 object-contain rounded bg-white">
                    <div class="flex-grow">
                        <p class="font-bold font-poppins">${item.name}</p>
                        <p class="text-sm text-gray-500">${item.size}</p>
                    </div>
                    <div class="flex items-center border rounded">
                        <button class="quantity-change px-3 py-1 text-lg" data-index="${index}" data-change="-1">-</button>
                        <span class="px-4 py-1 font-semibold">${item.quantity}</span>
                        <button class="quantity-change px-3 py-1 text-lg" data-index="${index}" data-change="1">+</button>
                    </div>
                    <p class="font-semibold w-24 text-right">₹${(item.price * item.quantity).toFixed(2)}</p>
                    <button class="remove-item text-gray-400 hover:text-red-500 transition" data-index="${index}"><i class="fas fa-trash text-lg"></i></button>`;
                cartItemsContainer.appendChild(itemEl);
                subtotal += item.price * item.quantity;
            });
            const deliveryFee = subtotal > 0 ? 20 : 0;
            cartSubtotalEl.textContent = `₹${subtotal.toFixed(2)}`;
            cartDeliveryFeeEl.textContent = `₹${deliveryFee.toFixed(2)}`;
            cartTotalEl.textContent = `₹${(subtotal + deliveryFee).toFixed(2)}`;
        }

        cartItemsContainer.addEventListener('click', e => {
            const target = e.target.closest('button');
            if (!target) return;
            const index = parseInt(target.dataset.index);
            if (target.classList.contains('quantity-change')) {
                const change = parseInt(target.dataset.change);
                cartItems[index].quantity += change;
                if (cartItems[index].quantity === 0) {
                    removeIndex = index;
                    confirmModal.classList.remove('hidden');
                } else {
                    updateCart();
                }
            } else if (target.classList.contains('remove-item')) {
                removeIndex = index;
                confirmModal.classList.remove('hidden');
            }
        });

        confirmRemoveBtn.addEventListener('click', () => {
            cartItems.splice(removeIndex, 1);
            confirmModal.classList.add('hidden');
            updateCart();
        });

        cancelRemoveBtn.addEventListener('click', () => {
            confirmModal.classList.add('hidden');
            removeIndex = null;
        });

        function showPage(pageId) {
            pageSections.forEach(section => section.classList.remove('active'));
            const activePage = document.getElementById(pageId);
            if (activePage) activePage.classList.add('active');
            window.scrollTo(0, 0);
            if (pageId === 'cart') updateCartView();
            observeSections();
        }

        function observeSections() {
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) entry.target.classList.add('visible');
                });
            }, { threshold: 0.1 });
            document.querySelectorAll('.animate-on-scroll').forEach(section => observer.observe(section));
        }

        function showToast(message) {
            toastMessage.textContent = message;
            toast.classList.remove('translate-y-20', 'opacity-0');
            toast.classList.add('translate-y-0', 'opacity-100');
            setTimeout(() => {
                toast.classList.add('translate-y-20', 'opacity-0');
                toast.classList.remove('translate-y-0', 'opacity-100');
            }, 3000);
        }

        // Back to Top Button
        window.addEventListener('scroll', () => {
            backToTopBtn.classList.toggle('hidden', window.scrollY < 300);
        });
        backToTopBtn.addEventListener('click', () => window.scrollTo({ top: 0, behavior: 'smooth' }));

        // Initialization
        function init() {
            navLinks.forEach(link => {
                link.addEventListener('click', function(e) {
                    const href = this.getAttribute('href');
                    if (href.startsWith('#')) {
                        e.preventDefault();
                        const pageId = href.substring(1);
                        if (document.getElementById(pageId)) {
                            history.pushState(null, '', `#${pageId}`);
                            showPage(pageId);
                            mobileMenu.classList.add('hidden');
                        }
                    }
                });
            });
            window.addEventListener('popstate', () => showPage(window.location.hash.substring(1) || 'home'));
            mobileMenuButton.addEventListener('click', () => mobileMenu.classList.toggle('hidden'));
            document.getElementById('cart-icon-link').addEventListener('click', e => {
                e.preventDefault();
                showPage('cart');
            });
            showPage(window.location.hash.substring(1) || 'home');
            renderProducts(products);
            renderFilters();
            renderHomePageContent();
            document.querySelector('.category-filter[data-category="All"]').classList.add('text-primary', 'font-bold');
            searchInput.addEventListener('input', debounce(handleFilter, 300));
            setTimeout(() => {
                loader.style.opacity = '0';
                setTimeout(() => loader.style.display = 'none', 500);
                observeSections();
            }, 500);
        }

        init();
    });
    </script>
</body>
</html>
